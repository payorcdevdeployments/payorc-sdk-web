(function(s,h){typeof exports=="object"&&typeof module<"u"?module.exports=h():typeof define=="function"&&define.amd?define(h):(s=typeof globalThis<"u"?globalThis:s||self,s.payorc=h())})(this,function(){"use strict";const o=class o{constructor(){this.apiKey="",this.merchantSecret="",this.environment="test",this.baseUrl="https://nodeserver.payorc.com/api/v1",this.mountElement=null,this.iframe=null,this.modal=null,this.eventListeners=[],this.config=null,window.addEventListener("message",this.handlePostMessage.bind(this))}static getInstance(){return o.instance||(o.instance=new o),o.instance}init(t){return this.apiKey=t.apiKey,this.merchantSecret=t.merchantSecret,this.environment=t.environment||"test",this.config=t,t.onSuccess&&this.on("success",t.onSuccess),t.onFailure&&this.on("failure",t.onFailure),t.onCancel&&this.on("cancel",t.onCancel),this}mount(t){return this.mountElement=document.getElementById(t),this.mountElement||console.error(`Element with ID "${t}" not found`),this}getBrowserInfo(){const t=navigator.platform||"unknown",e=navigator.userAgent;let i="unknown",r="unknown";if(e.indexOf("Chrome")!==-1){i="Chrome";const n=e.match(/Chrome\/(\d+\.\d+)/);n&&(r=n[1])}else if(e.indexOf("Firefox")!==-1){i="Firefox";const n=e.match(/Firefox\/(\d+\.\d+)/);n&&(r=n[1])}else if(e.indexOf("Safari")!==-1){i="Safari";const n=e.match(/Version\/(\d+\.\d+)/);n&&(r=n[1])}else if(e.indexOf("Edge")!==-1||e.indexOf("Edg")!==-1){i="Edge";const n=e.match(/Edge?\/(\d+\.\d+)/);n&&(r=n[1])}else if(e.indexOf("Opera")!==-1||e.indexOf("OPR")!==-1){i="Opera";const n=e.match(/OPR\/(\d+\.\d+)/);n&&(r=n[1])}return{platform:t,browser:i,browserVersion:r}}async createPayment(t,e="modal"){if(!this.apiKey||!this.merchantSecret)throw new Error("SDK not initialized. Call init() first.");if((e==="iframe"||e==="hosted")&&!this.mountElement)throw new Error("Mount element not found. Call mount() first for iframe or hosted mode.");try{const i={data:t},{platform:r,browser:n,browserVersion:l}=this.getBrowserInfo(),a=await(await fetch(`${this.baseUrl}/sdk/orders/create`,{method:"POST",headers:{"Content-Type":"application/json","merchant-key":this.apiKey,"merchant-secret":this.merchantSecret,platform:r,browser:n,"browser-version":l},body:JSON.stringify(i)})).json();if(a.status!=="SUCCESS")return this.triggerEvent("failure",a),null;switch(e){case"hosted":window.location.href=a.payment_link;break;case"iframe":this.loadIframe(a.iframe_link);break;case"modal":this.loadModal(a.iframe_link);break}return this.triggerEvent("processing",a),a}catch(i){return console.error("Error creating payment:",i),this.triggerEvent("failure",{error:i}),null}}on(t,e){return this.eventListeners.push({type:t,callback:e}),this}off(t,e){return this.eventListeners=this.eventListeners.filter(i=>!(i.type===t&&i.callback===e)),this}close(){this.modal&&(document.body.removeChild(this.modal),this.modal=null),this.iframe&&this.mountElement&&(this.mountElement.removeChild(this.iframe),this.iframe=null)}handlePostMessage(t){try{const e=typeof t.data=="string"?JSON.parse(t.data):t.data;e.status==="SUCCESS"?(this.triggerEvent("success",e),this.close()):e.status==="CANCELLED"?(this.triggerEvent("cancel",e),this.close()):e.status==="FAILED"&&(this.triggerEvent("failure",e),this.close())}catch(e){console.error("Error processing message:",e)}}triggerEvent(t,e){this.eventListeners.filter(i=>i.type===t).forEach(i=>{try{i.callback(e)}catch(r){console.error(`Error in ${t} event listener:`,r)}})}loadIframe(t){if(!this.mountElement){console.error("Mount element not found");return}this.mountElement.innerHTML="",this.iframe=document.createElement("iframe"),this.iframe.src=t,this.iframe.style.width="100%",this.iframe.style.height="600px",this.iframe.style.border="none",this.iframe.style.borderRadius="8px",this.iframe.setAttribute("allowpaymentrequest","true"),this.iframe.setAttribute("allow","payment"),this.mountElement.appendChild(this.iframe)}loadModal(t){this.modal=document.createElement("div"),Object.assign(this.modal.style,{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:"9999"});const e=document.createElement("div");Object.assign(e.style,{width:"90%",maxWidth:"600px",height:"90vh",backgroundColor:"#ffffff",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.15)",position:"relative",overflow:"hidden"}),this.iframe=document.createElement("iframe"),Object.assign(this.iframe.style,{width:"100%",height:"100%",border:"none"}),this.iframe.src=t,this.iframe.setAttribute("allowpaymentrequest","true"),this.iframe.setAttribute("allow","payment"),e.appendChild(this.iframe),this.modal.appendChild(e),this.modal.addEventListener("click",r=>{r.target===this.modal&&(r.preventDefault(),r.stopPropagation())});const i=document.createElement("style");i.textContent=`
      @media (max-width: 768px) {
        .payorc-modal-content {
          width: 95%;
          height: 95vh;
          margin: 10px;
        }
      }
    `,document.head.appendChild(i),e.classList.add("payorc-modal-content"),document.body.appendChild(this.modal)}};o.instance=null;let s=o;return s.getInstance()});
//# sourceMappingURL=payorc.umd.cjs.map